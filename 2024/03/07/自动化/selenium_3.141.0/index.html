<!-- build time:Wed Apr 03 2024 17:57:31 GMT+0800 (中国标准时间) --><!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/yangxs.github.io/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/yangxs.github.io/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="(人 •͈ᴗ•͈) ♡♡" href="https://sunforritual.github.io/yangxs.github.io/rss.xml"><link rel="alternate" type="application/atom+xml" title="(人 •͈ᴗ•͈) ♡♡" href="https://sunforritual.github.io/yangxs.github.io/atom.xml"><link rel="alternate" type="application/json" title="(人 •͈ᴗ•͈) ♡♡" href="https://sunforritual.github.io/yangxs.github.io/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/yangxs.github.io/css/app.css?v=0.2.5"><meta name="keywords" content="web自动化"><link rel="canonical" href="https://sunforritual.github.io/yangxs.github.io/2024/03/07/%E8%87%AA%E5%8A%A8%E5%8C%96/selenium_3.141.0/"><title>selenium 3.141.0 - 自动化 | yangxs = (人 •͈ᴗ•͈) ♡♡ = 不用担心，这次肯定不会有问题</title><meta name="generator" content="Hexo 6.3.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">selenium 3.141.0</h1><div class="meta"><span class="item" title="创建时间：2024-03-07 11:02:19"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2024-03-07T11:02:19+08:00">2024-03-07</time> </span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">本文字数</span> <span>7.8k</span> <span class="text">字</span> </span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">阅读时长</span> <span>20 分钟</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/yangxs.github.io/" rel="start">yangxs</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><img src="https://dlink.host/wx3.sinaimg.cn/large/006dC8hSly8hnbcc8qvmfj31hc0u0qfj.jpg"></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/yangxs.github.io/">首页</a></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/yangxs.github.io/categories/%E8%87%AA%E5%8A%A8%E5%8C%96/" itemprop="item" rel="index" title="分类于 自动化"><span itemprop="name">自动化</span></a><meta itemprop="position" content="1"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://sunforritual.github.io/yangxs.github.io/2024/03/07/%E8%87%AA%E5%8A%A8%E5%8C%96/selenium_3.141.0/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/yangxs.github.io/images/avatar.png"><meta itemprop="name" content="yangxs"><meta itemprop="description" content="不用担心，这次肯定不会有问题, "></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="(人 •͈ᴗ•͈) ♡♡"></span><div class="body md" itemprop="articleBody"><p><span class="exturl" data-url="aHR0cDovL2Nocm9tZWRyaXZlci5zdG9yYWdlLmdvb2dsZWFwaXMuY29tL2luZGV4Lmh0bWw=">Google 浏览器驱动程序下载地址</span></p><h3 id="一-安装"><a class="anchor" href="#一-安装">#</a> 一、安装</h3><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>pip install selenium</pre></td></tr></table></figure><h3 id="二-常用"><a class="anchor" href="#二-常用">#</a> 二、常用</h3><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>by <span class="token keyword">import</span> By</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver <span class="token keyword">import</span> ActionChains</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>keys <span class="token keyword">import</span> Keys</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>support<span class="token punctuation">.</span>ui <span class="token keyword">import</span> WebDriverWait</pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>support <span class="token keyword">import</span> expected_conditions <span class="token keyword">as</span> EC</pre></td></tr></table></figure><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>CHROME_DRIVER <span class="token operator">=</span> <span class="token string">r'D:\software\anaconda3\Scripts\chromedriver.exe'</span></pre></td></tr><tr><td data-num="2"></td><td><pre>chrome_options <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>ChromeOptions<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment"># 设置 屏幕大小</span></pre></td></tr><tr><td data-num="5"></td><td><pre>chrome_options<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">"window-size=1366,768"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token comment"># chrome_options.add_argument('--headless')</span></pre></td></tr><tr><td data-num="7"></td><td><pre>chrome_options<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">"-no-sandbox"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token comment"># chrome_options.add_argument("--disable-dev-shm-usage")</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre>chrome_options<span class="token punctuation">.</span>add_experimental_option<span class="token punctuation">(</span><span class="token string">'excludeSwitches'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'enable-automation'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="11"></td><td><pre>chrome_options<span class="token punctuation">.</span>add_experimental_option<span class="token punctuation">(</span><span class="token string">'prefs'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token string">"download.default_directory"</span><span class="token punctuation">:</span> config<span class="token punctuation">.</span>wgbgd_save<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token string">"download.prompt_for_download"</span><span class="token punctuation">:</span> <span class="token boolean">False</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token string">"download.directory_upgrade"</span><span class="token punctuation">:</span> <span class="token boolean">True</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token string">"plugins.always_open_pdf_externally"</span><span class="token punctuation">:</span> <span class="token boolean">True</span>  </pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="17"></td><td><pre>driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span>CHROME_DRIVER<span class="token punctuation">,</span> chrome_options<span class="token operator">=</span>chrome_options<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="18"></td><td><pre>wait <span class="token operator">=</span> WebDriverWait<span class="token punctuation">(</span>driver<span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token comment"># 等待</span></pre></td></tr><tr><td data-num="20"></td><td><pre>wait<span class="token punctuation">.</span>until<span class="token punctuation">(</span>EC<span class="token punctuation">.</span>presence_of_element_located<span class="token punctuation">(</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span>ID<span class="token punctuation">,</span> <span class="token string">'cardLogin'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="21"></td><td><pre>wait<span class="token punctuation">.</span>until<span class="token punctuation">(</span>EC<span class="token punctuation">.</span>element_to_be_clickable<span class="token punctuation">(</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span>ID<span class="token punctuation">,</span> <span class="token string">'cusAdvancedQuery'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token comment"># 等待页面所有元素加载完成</span></pre></td></tr><tr><td data-num="23"></td><td><pre>wait<span class="token punctuation">.</span>until<span class="token punctuation">(</span>EC<span class="token punctuation">.</span>presence_of_all_elements_located<span class="token punctuation">(</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span>CSS_SELECTOR<span class="token punctuation">,</span> <span class="token string">'*'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="24"></td><td><pre></pre></td></tr><tr><td data-num="25"></td><td><pre>driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span>config<span class="token punctuation">.</span>bgd_url<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="26"></td><td><pre>handles <span class="token operator">=</span> driver<span class="token punctuation">.</span>window_handles <span class="token comment"># 获取所有页面的句柄</span></pre></td></tr><tr><td data-num="27"></td><td><pre>driver<span class="token punctuation">.</span>switch_to<span class="token punctuation">.</span>window<span class="token punctuation">(</span>handles<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">#切换页面</span></pre></td></tr><tr><td data-num="28"></td><td><pre></pre></td></tr><tr><td data-num="29"></td><td><pre>driver<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr></table></figure><h3 id="三-入门"><a class="anchor" href="#三-入门">#</a> 三、入门</h3><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>keys <span class="token keyword">import</span> Keys</pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment"># 创建 Chrome 参数对象</span></pre></td></tr><tr><td data-num="6"></td><td><pre>chrome_options <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>ChromeOptions<span class="token punctuation">(</span><span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token comment">#无界面模式</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token comment">#chrome_options.add_argument('--headless') </span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token comment"># 浏览器驱动位置</span></pre></td></tr><tr><td data-num="10"></td><td><pre>path <span class="token operator">=</span> <span class="token string">r"D:\software\anaconda3\Scripts\chromedriver.exe"</span>  </pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token comment"># 获取 Chrome 驱动实例</span></pre></td></tr><tr><td data-num="12"></td><td><pre>driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span>executable_path<span class="token operator">=</span>path<span class="token punctuation">,</span> options<span class="token operator">=</span>opt<span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="13"></td><td><pre>driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'http://ww.baidu.com/'</span><span class="token punctuation">)</span>  <span class="token comment"># 打开指定网址页面</span></pre></td></tr></table></figure><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>driver<span class="token punctuation">.</span>page_source<span class="token punctuation">)</span>  <span class="token comment"># 输出网页的源代码</span></pre></td></tr></table></figure><h4 id="31-查找元素"><a class="anchor" href="#31-查找元素">#</a> 3.1 查找元素</h4><p>查找以下元素： <code>&lt;input type=&quot;text&quot; name=&quot;passwd&quot; id=&quot;passwd-id&quot; /&gt;</code></p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>element <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">"passwd-id"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre>element <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element_by_name<span class="token punctuation">(</span><span class="token string">"passwd"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre>element <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element_by_xpath<span class="token punctuation">(</span><span class="token string">"//input[@id='passwd-id']"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre>find_element_by_link_text  <span class="token comment"># 通过 & lt;a>..&lt;/a > 中的内容获取，属性 href 的值</span></pre></td></tr><tr><td data-num="6"></td><td><pre>find_element_by_partial_link_text</pre></td></tr><tr><td data-num="7"></td><td><pre>find_element_by_tag_name  <span class="token comment"># 通过标签名定位</span></pre></td></tr><tr><td data-num="8"></td><td><pre>find_element_by_class_name</pre></td></tr><tr><td data-num="9"></td><td><pre>find_element_by_css_selector</pre></td></tr></table></figure><hr><h4 id="321-获取元素的属性值"><a class="anchor" href="#321-获取元素的属性值">#</a> 3.2.1 获取元素的属性值</h4><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>element<span class="token punctuation">.</span>get_attribute<span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span></pre></td></tr></table></figure><h4 id="322-获取css属性值"><a class="anchor" href="#322-获取css属性值">#</a> 3.2.2 获取 css 属性值</h4><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>element<span class="token punctuation">.</span>value_of_css_property<span class="token punctuation">(</span><span class="token string">'display'</span><span class="token punctuation">)</span></pre></td></tr></table></figure><hr><h4 id="33-弹出对话框处理弹窗"><a class="anchor" href="#33-弹出对话框处理弹窗">#</a> 3.3 弹出对话框处理，弹窗</h4><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>alert <span class="token operator">=</span> driver<span class="token punctuation">.</span>switch_to_alert<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment"># 或</span></pre></td></tr><tr><td data-num="3"></td><td><pre>alert <span class="token operator">=</span> driver<span class="token punctuation">.</span>switch_to<span class="token punctuation">.</span>alert<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 常用</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre>alert<span class="token punctuation">.</span>accept<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 弹窗确定</span></pre></td></tr></table></figure><p>这个接口对 alert, confirm， prompt 对话框效果相同</p><hr><h4 id="34-访问浏览器历史记录"><a class="anchor" href="#34-访问浏览器历史记录">#</a> 3.4 访问浏览器历史记录</h4><pre><code>driver.get(&quot;http://www.example.com&quot;)
</code></pre><p>在浏览历史中前进和后退你可以使用:</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>driver<span class="token punctuation">.</span>forward<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre>driver<span class="token punctuation">.</span>back<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr></table></figure><h4 id="35-获取当前窗口的截图"><a class="anchor" href="#35-获取当前窗口的截图">#</a> 3.5 获取当前窗口的截图</h4><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver</pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre>driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Firefox<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre>driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'http://www.python.org/'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre>driver<span class="token punctuation">.</span>save_screenshot<span class="token punctuation">(</span><span class="token string">'screenshot.png'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre>driver<span class="token punctuation">.</span>quit<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr></table></figure><h4 id="35-避免自动操作检测"><a class="anchor" href="#35-避免自动操作检测">#</a> 3.5 避免自动操作检测</h4><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>driver<span class="token punctuation">.</span>execute_cdp_cmd<span class="token punctuation">(</span><span class="token string">"Page.addScriptToEvaluateOnNewDocument"</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>        <span class="token string">"source"</span><span class="token punctuation">:</span> <span class="token triple-quoted-string string">"""</span></pre></td></tr><tr><td data-num="3"></td><td><pre>                Object.defineProperty(navigator, 'webdriver', &#123;</pre></td></tr><tr><td data-num="4"></td><td><pre>                  get: () => undefined</pre></td></tr><tr><td data-num="5"></td><td><pre>                &#125;)</pre></td></tr><tr><td data-num="6"></td><td><pre>              """</pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr></table></figure><h4 id="37-窗口最大化"><a class="anchor" href="#37-窗口最大化">#</a> 3.7 窗口最大化</h4><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>driver<span class="token punctuation">.</span>maximize_window<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr></table></figure><h4 id="38-切换iframe"><a class="anchor" href="#38-切换iframe">#</a> 3.8 切换 iframe</h4><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>iframe <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">'menu'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre>driver<span class="token punctuation">.</span>switch_to<span class="token punctuation">.</span>frame<span class="token punctuation">(</span>iframe<span class="token punctuation">)</span></pre></td></tr></table></figure><h5 id="381-通过元素的id-或name属性切换"><a class="anchor" href="#381-通过元素的id-或name属性切换">#</a> 3.8.1 通过元素的 id 或 name 属性切换</h5><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>driver<span class="token punctuation">,</span>switch_to_frame<span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span> <span class="token comment">#参数传 frame id 或者 name</span></pre></td></tr></table></figure><h5 id="382-通过元素索引切换"><a class="anchor" href="#382-通过元素索引切换">#</a> 3.8.2 通过元素索引切换</h5><p>#通过索引切换 注意索引从 0 开始 注意 只有同级可以使用 索引切换 如果是嵌套的 frame 是不能使用索引切换的</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>driver<span class="token punctuation">.</span>switch_to<span class="token punctuation">.</span>frame<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr></table></figure><h5 id="383-通过定位元素的方式切换"><a class="anchor" href="#383-通过定位元素的方式切换">#</a> 3.8.3 通过定位元素的方式切换</h5><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>driver<span class="token punctuation">.</span>switch_to<span class="token punctuation">.</span>frame<span class="token punctuation">(</span>driver<span class="token punctuation">.</span>find_elements_by_tag_name<span class="token punctuation">(</span><span class="token string">"iframe"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr></table></figure><h5 id="384-切换嵌套iframe"><a class="anchor" href="#384-切换嵌套iframe">#</a> 3.8.4 切换嵌套 iframe</h5><p>同上 可以先切换到父 iframe 然后再切换到子 iframe</p><h5 id="385-从子iframe-切换到父级-iframe"><a class="anchor" href="#385-从子iframe-切换到父级-iframe">#</a> 3.8.5 从子 iframe 切换到父级 iframe</h5><pre><code>driver.switch_to.parent_frame()
</code></pre><h5 id="386-切换回主文档-即跳出所有iframe"><a class="anchor" href="#386-切换回主文档-即跳出所有iframe">#</a> 3.8.6 切换回主文档 ，即跳出所有 iframe</h5><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>driver<span class="token punctuation">.</span>switch_to<span class="token punctuation">.</span>default_content<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p>————————————————<br>版权声明：本文为 CSDN 博主「词穷墨尽」的原创文章，遵循 CC 4.0 BY-SA 版权协议，转载请附上原文出处链接及本声明。<br>原文链接：<span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MTE2NzE1MC9hcnRpY2xlL2RldGFpbHMvMTA5NTIyNjg1">https://blog.csdn.net/weixin_41167150/article/details/109522685</span></p><hr><h3 id="四-等待"><a class="anchor" href="#四-等待">#</a> 四、等待</h3><p><strong>显式等待</strong>会让 WebDriver 等待满足一定的条件以后再进一步的执行。</p><p><strong>隐式等待</strong>设置一个全局的最长等待时间，在查找元素时等待一段时间，如果元素在这个时间内找到了就立即执行操作，如果超过了这个时间还没有找到元素，则抛出异常。</p><h4 id="41-显式等待"><a class="anchor" href="#41-显式等待">#</a> 4.1 显式等待</h4><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>by <span class="token keyword">import</span> By</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>support<span class="token punctuation">.</span>ui <span class="token keyword">import</span> WebDriverWait</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>support <span class="token keyword">import</span> expected_conditions <span class="token keyword">as</span> EC</pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre>driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Firefox<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre>driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"http://somedomain/url_that_delays_loading"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">try</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token comment"># 等待，直到 id=myDynamicElement 的元素加载后在继续执行</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    element <span class="token operator">=</span> WebDriverWait<span class="token punctuation">(</span>driver<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">.</span>until<span class="token punctuation">(</span>EC<span class="token punctuation">.</span>presence_of_element_located<span class="token punctuation">(</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span>ID<span class="token punctuation">,</span> <span class="token string">"myDynamicElement"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token comment"># 等待，直到 id=cusAdvancedQuery 的元素，可被点击后继续执行</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    element <span class="token operator">=</span> WebDriverWait<span class="token punctuation">(</span>driver<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">.</span>until<span class="token punctuation">(</span>EC<span class="token punctuation">.</span>element_to_be_clickable<span class="token punctuation">(</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span>ID<span class="token punctuation">,</span> <span class="token string">'cusAdvancedQuery'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">finally</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    driver<span class="token punctuation">.</span>quit<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p>等待 10s，如果 10s 内 id=myDynamicElement 的元素加载成功，则直接进入下一步。</p><h4 id="42-隐式等待"><a class="anchor" href="#42-隐式等待">#</a> 4.2 隐式等待</h4><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver</pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre>driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Firefox<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre>driver<span class="token punctuation">.</span>implicitly_wait<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token comment"># 设置全局的最长等待时间</span></pre></td></tr><tr><td data-num="5"></td><td><pre>driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"http://somedomain/url_that_delays_loading"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre>myDynamicElement <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">"myDynamicElement"</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p>隐式等待可以理解成在规定的时间范围内，浏览器在不停的刷新页面，直到找到相关元素或者时间结束。</p><hr><h4 id="关闭"><a class="anchor" href="#关闭">#</a> 关闭</h4><p>关闭浏览器窗口，可以使用 quit 方法代替 close 方法， quit 将关闭整个浏览器，而 close 只会关闭一个标签页， 如果你只打开了一个标签页，大多数浏览器的默认行为是关闭浏览器。</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>element<span class="token punctuation">.</span>clear<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre>element<span class="token punctuation">.</span>quit<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr></table></figure><h3 id="五-截图"><a class="anchor" href="#五-截图">#</a> 五、截图</h3><h4 id="1-指定元素截图"><a class="anchor" href="#1-指定元素截图">#</a> 1、指定元素截图</h4><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>img <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">'image1'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre>img<span class="token punctuation">.</span>screenshot<span class="token punctuation">(</span><span class="token string">'./code.png'</span><span class="token punctuation">)</span></pre></td></tr></table></figure><h4 id="2-网页全屏截图"><a class="anchor" href="#2-网页全屏截图">#</a> 2、网页全屏截图</h4><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>driver<span class="token punctuation">.</span>save_screenshot<span class="token punctuation">(</span><span class="token string">'./full_snap.png'</span><span class="token punctuation">)</span></pre></td></tr></table></figure><h3 id="六-模拟鼠标键盘操作"><a class="anchor" href="#六-模拟鼠标键盘操作">#</a> 六、模拟鼠标 / 键盘操作</h3><h4 id="61-输入内容"><a class="anchor" href="#61-输入内容">#</a> 6.1 输入内容</h4><p>模拟键盘输入操作</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>element<span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span><span class="token string">"some text"</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p>还可以通过”Keys” 类来模式输入方向键</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>element<span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span><span class="token string">" and some"</span><span class="token punctuation">,</span> Keys<span class="token punctuation">.</span>ARROW_DOWN<span class="token punctuation">)</span></pre></td></tr></table></figure><pre><code>1、回车键：Keys.ENTER
2、删除键：Keys.BACK_SPACE
3、空格键：Keys.SPACE
4、制表键：Keys.TAB
5、回退键：Keys.ESCAPE
6、刷新键：Keys.F5
7、删除输入框内结尾的单个字符：Keys.BACK_SPACE  
# Keys.LEFT 光标左移
dr.find_element_by_id(&quot;kw&quot;).send_keys(Keys.LEFT * 3)
# shift + right 右移光标选中
dr.find_element_by_id(&quot;kw&quot;).send_keys(Keys.SHIFT, Keys.RIGHT * 3)
</code></pre><p>常用组合键操作 Ctrl+__</p><figure class="highlight text"><figcaption data-lang="text"></figcaption><table><tr><td data-num="1"></td><td><pre>1、全选：send_keys(Keys.CONTROL,'a')</pre></td></tr><tr><td data-num="2"></td><td><pre>2、复制：send_keys(Keys.CONTROL,'c')</pre></td></tr><tr><td data-num="3"></td><td><pre>3、粘贴：send_keys(Keys.CONTROL,'v')</pre></td></tr><tr><td data-num="4"></td><td><pre>4、剪切：send_keys(Keys.CONTROL,'x')</pre></td></tr></table></figure><p>使用 ActionChains 类可以达到相同的效果</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>driver<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">"passwd-id"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment"># 初始化一个 ActionChains 类</span></pre></td></tr><tr><td data-num="3"></td><td><pre>action <span class="token operator">=</span> ActionChains<span class="token punctuation">(</span>driver<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment"># 选中内容</span></pre></td></tr><tr><td data-num="5"></td><td><pre>action<span class="token punctuation">.</span>key_down<span class="token punctuation">(</span>Keys<span class="token punctuation">.</span>CONTROL<span class="token punctuation">)</span><span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>key_up<span class="token punctuation">(</span>Keys<span class="token punctuation">.</span>CONTROL<span class="token punctuation">)</span><span class="token punctuation">.</span>perform<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token comment"># 复制内容</span></pre></td></tr><tr><td data-num="7"></td><td><pre>action<span class="token punctuation">.</span>key_down<span class="token punctuation">(</span>Keys<span class="token punctuation">.</span>CONTROL<span class="token punctuation">)</span><span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span><span class="token string">'c'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>key_up<span class="token punctuation">(</span>Keys<span class="token punctuation">.</span>CONTROL<span class="token punctuation">)</span><span class="token punctuation">.</span>perform<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token comment"># 粘贴内容</span></pre></td></tr><tr><td data-num="9"></td><td><pre>action<span class="token punctuation">.</span>key_down<span class="token punctuation">(</span>Keys<span class="token punctuation">.</span>CONTROL<span class="token punctuation">)</span><span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span><span class="token string">'v'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>key_up<span class="token punctuation">(</span>Keys<span class="token punctuation">.</span>CONTROL<span class="token punctuation">)</span><span class="token punctuation">.</span>perform<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr></table></figure><hr><h4 id="62-多选框选择操作"><a class="anchor" href="#62-多选框选择操作">#</a> 6.2 多选框选择操作</h4><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>support<span class="token punctuation">.</span>ui <span class="token keyword">import</span> Select</pre></td></tr><tr><td data-num="2"></td><td><pre>select <span class="token operator">=</span> Select<span class="token punctuation">(</span>driver<span class="token punctuation">.</span>find_element_by_name<span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre>select<span class="token punctuation">.</span>select_by_index<span class="token punctuation">(</span>index<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre>select<span class="token punctuation">.</span>select_by_visible_text<span class="token punctuation">(</span><span class="token string">"text"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre>select<span class="token punctuation">.</span>select_by_value<span class="token punctuation">(</span>value<span class="token punctuation">)</span></pre></td></tr></table></figure><h5 id="621-取消已经选择的一些元素"><a class="anchor" href="#621-取消已经选择的一些元素">#</a> 6.2.1 取消已经选择的一些元素</h5><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>select <span class="token operator">=</span> Select<span class="token punctuation">(</span>driver<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre>select<span class="token punctuation">.</span>deselect_all<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr></table></figure><h5 id="622-列出所有已经选择的选项"><a class="anchor" href="#622-列出所有已经选择的选项">#</a> 6.2.2 列出所有已经选择的选项</h5><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>select <span class="token operator">=</span> Select<span class="token punctuation">(</span>driver<span class="token punctuation">.</span>find_element_by_xpath<span class="token punctuation">(</span><span class="token string">"xpath"</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre>all_selected_options <span class="token operator">=</span> select<span class="token punctuation">.</span>all_selected_options</pre></td></tr></table></figure><h5 id="623-获得所以选项"><a class="anchor" href="#623-获得所以选项">#</a> 6.2.3 获得所以选项</h5><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>options <span class="token operator">=</span> select<span class="token punctuation">.</span>options</pre></td></tr></table></figure><hr><h4 id="63-拖放"><a class="anchor" href="#63-拖放">#</a> 6.3 拖放</h4><p>可以使用拖放，无论是移动一个元素，或放到另一个元素内:</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>element <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element_by_name<span class="token punctuation">(</span><span class="token string">"source"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre>target <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element_by_name<span class="token punctuation">(</span><span class="token string">"target"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver <span class="token keyword">import</span> ActionChains</pre></td></tr><tr><td data-num="5"></td><td><pre>action_chains <span class="token operator">=</span> ActionChains<span class="token punctuation">(</span>driver<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre>action_chains<span class="token punctuation">.</span>drag_and_drop<span class="token punctuation">(</span>element<span class="token punctuation">,</span> target<span class="token punctuation">)</span><span class="token punctuation">.</span>perform<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr></table></figure><hr><h4 id="64-页面滚动"><a class="anchor" href="#64-页面滚动">#</a> 6.4 页面滚动</h4><h5 id="641-滚动到页面底部"><a class="anchor" href="#641-滚动到页面底部">#</a> 6.4.1 滚动到页面底部</h5><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>driver<span class="token punctuation">.</span>execute_script<span class="token punctuation">(</span><span class="token string">"window.scrollTo(0, document.body.scrollHeight);"</span><span class="token punctuation">)</span></pre></td></tr></table></figure><h5 id="642-滚动到指定为止"><a class="anchor" href="#642-滚动到指定为止">#</a> 6.4.2 滚动到指定为止</h5><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>driver<span class="token punctuation">.</span>execute_script<span class="token punctuation">(</span><span class="token string">"document.documentElement.scrollTop = 11245"</span><span class="token punctuation">)</span></pre></td></tr></table></figure><h5 id="643-循环滚动到指定为止"><a class="anchor" href="#643-循环滚动到指定为止">#</a> 6.4.3 循环滚动到指定为止</h5><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10767</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    js_code <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f'document.documentElement.scrollTop = </span><span class="token interpolation"><span class="token punctuation">&#123;</span>i<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span></pre></td></tr><tr><td data-num="3"></td><td><pre>    driver<span class="token punctuation">.</span>execute_script<span class="token punctuation">(</span>js_code<span class="token punctuation">)</span></pre></td></tr></table></figure><hr><h4 id="65-鼠标悬浮"><a class="anchor" href="#65-鼠标悬浮">#</a> 6.5 鼠标悬浮</h4><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>action_chains <span class="token keyword">import</span> ActionChains</pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre>app_top <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">'AppTop_currentli'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment"># 将鼠标放置在 app_top 元素上</span></pre></td></tr><tr><td data-num="5"></td><td><pre>my_action<span class="token punctuation">.</span>move_to_element<span class="token punctuation">(</span>app_top<span class="token punctuation">)</span><span class="token punctuation">.</span>perform<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr></table></figure><hr><h4 id="66-鼠标点击事件"><a class="anchor" href="#66-鼠标点击事件">#</a> 6.6 鼠标点击事件</h4><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>action_chains <span class="token keyword">import</span> ActionChains</pre></td></tr></table></figure><h5 id="661-右击"><a class="anchor" href="#661-右击">#</a> 6.6.1 右击</h5><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>rc <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">"rightclickid"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre>ActionChains<span class="token punctuation">(</span>driver<span class="token punctuation">)</span><span class="token punctuation">.</span>context_click<span class="token punctuation">(</span>rc<span class="token punctuation">)</span><span class="token punctuation">.</span>perform<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr></table></figure><h5 id="662-双击"><a class="anchor" href="#662-双击">#</a> 6.6.2 双击</h5><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>rc <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">"rightclickid"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre>ActionChains<span class="token punctuation">(</span>driver<span class="token punctuation">)</span><span class="token punctuation">.</span>double_click<span class="token punctuation">(</span>rc<span class="token punctuation">)</span><span class="token punctuation">.</span>perform<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr></table></figure><h5 id="663-移动"><a class="anchor" href="#663-移动">#</a> 6.6.3 移动</h5><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#定位元素的原位置</span></pre></td></tr><tr><td data-num="2"></td><td><pre>element <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element_by_name<span class="token punctuation">(</span><span class="token string">"source"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">#定位元素要移动到的目标位置</span></pre></td></tr><tr><td data-num="4"></td><td><pre>target <span class="token operator">=</span>  driver<span class="token punctuation">.</span>find_element_by_name<span class="token punctuation">(</span><span class="token string">"target"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">#执行元素的移动操作</span></pre></td></tr><tr><td data-num="6"></td><td><pre>ActionChains<span class="token punctuation">(</span>driver<span class="token punctuation">)</span><span class="token punctuation">.</span>drag_and_drop<span class="token punctuation">(</span>element<span class="token punctuation">,</span> target<span class="token punctuation">)</span><span class="token punctuation">.</span>perform<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr></table></figure><h4 id="67-模拟鼠标滚动"><a class="anchor" href="#67-模拟鼠标滚动">#</a> 6.7 模拟鼠标滚动</h4><h5 id="671-滚动到页面底部"><a class="anchor" href="#671-滚动到页面底部">#</a> 6.7.1 滚动到页面底部</h5><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>js <span class="token operator">=</span> <span class="token string">"window.scrollTo(0, document.body.scrollHeight)"</span></pre></td></tr><tr><td data-num="2"></td><td><pre>driver<span class="token punctuation">.</span>execute_script<span class="token punctuation">(</span>js<span class="token punctuation">)</span></pre></td></tr></table></figure><h5 id="672-滚动到页面顶部"><a class="anchor" href="#672-滚动到页面顶部">#</a> 6.7.2 滚动到页面顶部</h5><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>js <span class="token operator">=</span> <span class="token string">"window.scrollTo(0, 0)"</span></pre></td></tr><tr><td data-num="2"></td><td><pre>driver<span class="token punctuation">.</span>execute_script<span class="token punctuation">(</span>js<span class="token punctuation">)</span></pre></td></tr></table></figure><h5 id="673-指定滚动距离"><a class="anchor" href="#673-指定滚动距离">#</a> 6.7.3 指定滚动距离</h5><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>js <span class="token operator">=</span> <span class="token string">"document.documentElement.scrollTop=7000"</span></pre></td></tr><tr><td data-num="2"></td><td><pre>driver<span class="token punctuation">.</span>execute_script<span class="token punctuation">(</span>js<span class="token punctuation">)</span></pre></td></tr></table></figure><hr><h3 id="七-运行js代码"><a class="anchor" href="#七-运行js代码">#</a> 七、运行 js 代码</h3><h4 id="71-获取浏览器中某个变量的值"><a class="anchor" href="#71-获取浏览器中某个变量的值">#</a> 7.1 获取浏览器中某个变量的值</h4><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>briver<span class="token punctuation">.</span>execute_script<span class="token punctuation">(</span><span class="token string">"return 变量名"</span><span class="token punctuation">)</span></pre></td></tr></table></figure><h4 id="72-获取网页中的图片"><a class="anchor" href="#72-获取网页中的图片">#</a> 7.2 获取网页中的图片</h4><p>获取 canvas 标签生成的图片，</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>img_bs64 <span class="token operator">=</span> briver<span class="token punctuation">.</span>execute_script<span class="token punctuation">(</span><span class="token string">"return document.getElementsByClassName('图片元素的class')[0].toDataURL('image/png')"</span><span class="token punctuation">)</span>  <span class="token comment"># 返回涵图片 base64 位编码的字符串</span></pre></td></tr><tr><td data-num="2"></td><td><pre>img_base <span class="token operator">=</span> img_bs64<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>   <span class="token comment"># 截取图片的 base64 位编码的字符串</span></pre></td></tr><tr><td data-num="3"></td><td><pre>img_base <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>img_base<span class="token punctuation">)</span>  <span class="token comment"># 将 base64 编码数据转为 byte</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'bg.png'</span><span class="token punctuation">,</span> <span class="token string">'wb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>img_base<span class="token punctuation">)</span></pre></td></tr></table></figure><div class="tags"><a href="/yangxs.github.io/tags/web%E8%87%AA%E5%8A%A8%E5%8C%96/" rel="tag"><i class="ic i-tag"></i> web自动化</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">更新于</span> <time title="修改时间：2024-03-07 11:07:06" itemprop="dateModified" datetime="2024-03-07T11:07:06+08:00">2024-03-07</time> </span><span id="2024/03/07/自动化/selenium_3.141.0/" class="item leancloud_visitors" data-flag-title="selenium 3.141.0" title="阅读次数"><span class="icon"><i class="ic i-eye"></i> </span><span class="text">阅读次数</span> <span class="leancloud-visitors-count"></span> <span class="text">次</span></span></div><div class="reward"><button><i class="ic i-heartbeat"></i> 赞赏</button><p>请我喝[茶]~(￣▽￣)~*</p><div id="qr"><div><img data-src="/yangxs.github.io/images/wechatpay.png" alt="yangxs 微信支付"><p>微信支付</p></div><div><img data-src="/yangxs.github.io/images/alipay.png" alt="yangxs 支付宝"><p>支付宝</p></div></div></div><div id="copyright"><ul><li class="author"><strong>本文作者： </strong>yangxs <i class="ic i-at"><em>@</em></i>(人 •͈ᴗ•͈) ♡♡</li><li class="link"><strong>本文链接：</strong> <a href="https://sunforritual.github.io/yangxs.github.io/2024/03/07/%E8%87%AA%E5%8A%A8%E5%8C%96/selenium_3.141.0/" title="selenium 3.141.0">https://sunforritual.github.io/yangxs.github.io/2024/03/07/自动化/selenium_3.141.0/</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/yangxs.github.io/2024/03/07/%E8%87%AA%E5%8A%A8%E5%8C%96/selenium_4.10/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;dlink.host&#x2F;wx2.sinaimg.cn&#x2F;large&#x2F;006dC8hSly8hnbcc5kjy1j31hc0u013x.jpg" title="selenium 4.10"><span class="type">上一篇</span> <span class="category"><i class="ic i-flag"></i> 自动化</span><h3>selenium 4.10</h3></a></div><div class="item right"><a href="/yangxs.github.io/2024/03/07/spider/Java%E7%88%AC%E8%99%AB%E5%AE%9E%E7%8E%B0/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;raw.githubusercontent.com&#x2F;sunForRitual&#x2F;imgCollector&#x2F;master&#x2F;blog&#x2F;10.jpg" title="Java爬虫"><span class="type">下一篇</span> <span class="category"><i class="ic i-flag"></i> spider</span><h3>Java爬虫</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80-%E5%AE%89%E8%A3%85"><span class="toc-number">1.</span> <span class="toc-text">一、安装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C-%E5%B8%B8%E7%94%A8"><span class="toc-number">2.</span> <span class="toc-text">二、常用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%89-%E5%85%A5%E9%97%A8"><span class="toc-number">3.</span> <span class="toc-text">三、入门</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#31-%E6%9F%A5%E6%89%BE%E5%85%83%E7%B4%A0"><span class="toc-number">3.1.</span> <span class="toc-text">3.1 查找元素</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#321-%E8%8E%B7%E5%8F%96%E5%85%83%E7%B4%A0%E7%9A%84%E5%B1%9E%E6%80%A7%E5%80%BC"><span class="toc-number">3.2.</span> <span class="toc-text">3.2.1 获取元素的属性值</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#322-%E8%8E%B7%E5%8F%96css%E5%B1%9E%E6%80%A7%E5%80%BC"><span class="toc-number">3.3.</span> <span class="toc-text">3.2.2 获取 css 属性值</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#33-%E5%BC%B9%E5%87%BA%E5%AF%B9%E8%AF%9D%E6%A1%86%E5%A4%84%E7%90%86%E5%BC%B9%E7%AA%97"><span class="toc-number">3.4.</span> <span class="toc-text">3.3 弹出对话框处理，弹窗</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#34-%E8%AE%BF%E9%97%AE%E6%B5%8F%E8%A7%88%E5%99%A8%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95"><span class="toc-number">3.5.</span> <span class="toc-text">3.4 访问浏览器历史记录</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#35-%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E7%AA%97%E5%8F%A3%E7%9A%84%E6%88%AA%E5%9B%BE"><span class="toc-number">3.6.</span> <span class="toc-text">3.5 获取当前窗口的截图</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#35-%E9%81%BF%E5%85%8D%E8%87%AA%E5%8A%A8%E6%93%8D%E4%BD%9C%E6%A3%80%E6%B5%8B"><span class="toc-number">3.7.</span> <span class="toc-text">3.5 避免自动操作检测</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#37-%E7%AA%97%E5%8F%A3%E6%9C%80%E5%A4%A7%E5%8C%96"><span class="toc-number">3.8.</span> <span class="toc-text">3.7 窗口最大化</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#38-%E5%88%87%E6%8D%A2iframe"><span class="toc-number">3.9.</span> <span class="toc-text">3.8 切换 iframe</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#381-%E9%80%9A%E8%BF%87%E5%85%83%E7%B4%A0%E7%9A%84id-%E6%88%96name%E5%B1%9E%E6%80%A7%E5%88%87%E6%8D%A2"><span class="toc-number">3.9.1.</span> <span class="toc-text">3.8.1 通过元素的 id 或 name 属性切换</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#382-%E9%80%9A%E8%BF%87%E5%85%83%E7%B4%A0%E7%B4%A2%E5%BC%95%E5%88%87%E6%8D%A2"><span class="toc-number">3.9.2.</span> <span class="toc-text">3.8.2 通过元素索引切换</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#383-%E9%80%9A%E8%BF%87%E5%AE%9A%E4%BD%8D%E5%85%83%E7%B4%A0%E7%9A%84%E6%96%B9%E5%BC%8F%E5%88%87%E6%8D%A2"><span class="toc-number">3.9.3.</span> <span class="toc-text">3.8.3 通过定位元素的方式切换</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#384-%E5%88%87%E6%8D%A2%E5%B5%8C%E5%A5%97iframe"><span class="toc-number">3.9.4.</span> <span class="toc-text">3.8.4 切换嵌套 iframe</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#385-%E4%BB%8E%E5%AD%90iframe-%E5%88%87%E6%8D%A2%E5%88%B0%E7%88%B6%E7%BA%A7-iframe"><span class="toc-number">3.9.5.</span> <span class="toc-text">3.8.5 从子 iframe 切换到父级 iframe</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#386-%E5%88%87%E6%8D%A2%E5%9B%9E%E4%B8%BB%E6%96%87%E6%A1%A3-%E5%8D%B3%E8%B7%B3%E5%87%BA%E6%89%80%E6%9C%89iframe"><span class="toc-number">3.9.6.</span> <span class="toc-text">3.8.6 切换回主文档 ，即跳出所有 iframe</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%9B-%E7%AD%89%E5%BE%85"><span class="toc-number">4.</span> <span class="toc-text">四、等待</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#41-%E6%98%BE%E5%BC%8F%E7%AD%89%E5%BE%85"><span class="toc-number">4.1.</span> <span class="toc-text">4.1 显式等待</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#42-%E9%9A%90%E5%BC%8F%E7%AD%89%E5%BE%85"><span class="toc-number">4.2.</span> <span class="toc-text">4.2 隐式等待</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%B3%E9%97%AD"><span class="toc-number">4.3.</span> <span class="toc-text">关闭</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%94-%E6%88%AA%E5%9B%BE"><span class="toc-number">5.</span> <span class="toc-text">五、截图</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E6%8C%87%E5%AE%9A%E5%85%83%E7%B4%A0%E6%88%AA%E5%9B%BE"><span class="toc-number">5.1.</span> <span class="toc-text">1、指定元素截图</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E7%BD%91%E9%A1%B5%E5%85%A8%E5%B1%8F%E6%88%AA%E5%9B%BE"><span class="toc-number">5.2.</span> <span class="toc-text">2、网页全屏截图</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%AD-%E6%A8%A1%E6%8B%9F%E9%BC%A0%E6%A0%87%E9%94%AE%E7%9B%98%E6%93%8D%E4%BD%9C"><span class="toc-number">6.</span> <span class="toc-text">六、模拟鼠标 &#x2F; 键盘操作</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#61-%E8%BE%93%E5%85%A5%E5%86%85%E5%AE%B9"><span class="toc-number">6.1.</span> <span class="toc-text">6.1 输入内容</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#62-%E5%A4%9A%E9%80%89%E6%A1%86%E9%80%89%E6%8B%A9%E6%93%8D%E4%BD%9C"><span class="toc-number">6.2.</span> <span class="toc-text">6.2 多选框选择操作</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#621-%E5%8F%96%E6%B6%88%E5%B7%B2%E7%BB%8F%E9%80%89%E6%8B%A9%E7%9A%84%E4%B8%80%E4%BA%9B%E5%85%83%E7%B4%A0"><span class="toc-number">6.2.1.</span> <span class="toc-text">6.2.1 取消已经选择的一些元素</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#622-%E5%88%97%E5%87%BA%E6%89%80%E6%9C%89%E5%B7%B2%E7%BB%8F%E9%80%89%E6%8B%A9%E7%9A%84%E9%80%89%E9%A1%B9"><span class="toc-number">6.2.2.</span> <span class="toc-text">6.2.2 列出所有已经选择的选项</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#623-%E8%8E%B7%E5%BE%97%E6%89%80%E4%BB%A5%E9%80%89%E9%A1%B9"><span class="toc-number">6.2.3.</span> <span class="toc-text">6.2.3 获得所以选项</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#63-%E6%8B%96%E6%94%BE"><span class="toc-number">6.3.</span> <span class="toc-text">6.3 拖放</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#64-%E9%A1%B5%E9%9D%A2%E6%BB%9A%E5%8A%A8"><span class="toc-number">6.4.</span> <span class="toc-text">6.4 页面滚动</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#641-%E6%BB%9A%E5%8A%A8%E5%88%B0%E9%A1%B5%E9%9D%A2%E5%BA%95%E9%83%A8"><span class="toc-number">6.4.1.</span> <span class="toc-text">6.4.1 滚动到页面底部</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#642-%E6%BB%9A%E5%8A%A8%E5%88%B0%E6%8C%87%E5%AE%9A%E4%B8%BA%E6%AD%A2"><span class="toc-number">6.4.2.</span> <span class="toc-text">6.4.2 滚动到指定为止</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#643-%E5%BE%AA%E7%8E%AF%E6%BB%9A%E5%8A%A8%E5%88%B0%E6%8C%87%E5%AE%9A%E4%B8%BA%E6%AD%A2"><span class="toc-number">6.4.3.</span> <span class="toc-text">6.4.3 循环滚动到指定为止</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#65-%E9%BC%A0%E6%A0%87%E6%82%AC%E6%B5%AE"><span class="toc-number">6.5.</span> <span class="toc-text">6.5 鼠标悬浮</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#66-%E9%BC%A0%E6%A0%87%E7%82%B9%E5%87%BB%E4%BA%8B%E4%BB%B6"><span class="toc-number">6.6.</span> <span class="toc-text">6.6 鼠标点击事件</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#661-%E5%8F%B3%E5%87%BB"><span class="toc-number">6.6.1.</span> <span class="toc-text">6.6.1 右击</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#662-%E5%8F%8C%E5%87%BB"><span class="toc-number">6.6.2.</span> <span class="toc-text">6.6.2 双击</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#663-%E7%A7%BB%E5%8A%A8"><span class="toc-number">6.6.3.</span> <span class="toc-text">6.6.3 移动</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#67-%E6%A8%A1%E6%8B%9F%E9%BC%A0%E6%A0%87%E6%BB%9A%E5%8A%A8"><span class="toc-number">6.7.</span> <span class="toc-text">6.7 模拟鼠标滚动</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#671-%E6%BB%9A%E5%8A%A8%E5%88%B0%E9%A1%B5%E9%9D%A2%E5%BA%95%E9%83%A8"><span class="toc-number">6.7.1.</span> <span class="toc-text">6.7.1 滚动到页面底部</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#672-%E6%BB%9A%E5%8A%A8%E5%88%B0%E9%A1%B5%E9%9D%A2%E9%A1%B6%E9%83%A8"><span class="toc-number">6.7.2.</span> <span class="toc-text">6.7.2 滚动到页面顶部</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#673-%E6%8C%87%E5%AE%9A%E6%BB%9A%E5%8A%A8%E8%B7%9D%E7%A6%BB"><span class="toc-number">6.7.3.</span> <span class="toc-text">6.7.3 指定滚动距离</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%83-%E8%BF%90%E8%A1%8Cjs%E4%BB%A3%E7%A0%81"><span class="toc-number">7.</span> <span class="toc-text">七、运行 js 代码</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#71-%E8%8E%B7%E5%8F%96%E6%B5%8F%E8%A7%88%E5%99%A8%E4%B8%AD%E6%9F%90%E4%B8%AA%E5%8F%98%E9%87%8F%E7%9A%84%E5%80%BC"><span class="toc-number">7.1.</span> <span class="toc-text">7.1 获取浏览器中某个变量的值</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#72-%E8%8E%B7%E5%8F%96%E7%BD%91%E9%A1%B5%E4%B8%AD%E7%9A%84%E5%9B%BE%E7%89%87"><span class="toc-number">7.2.</span> <span class="toc-text">7.2 获取网页中的图片</span></a></li></ol></li></ol></div><div class="related panel pjax" data-title="系列文章"><ul><li><a href="/yangxs.github.io/2024/03/07/%E8%87%AA%E5%8A%A8%E5%8C%96/pyautogui%E8%87%AA%E5%8A%A8%E5%8C%96/" rel="bookmark" title="pyautogui">pyautogui</a></li><li><a href="/yangxs.github.io/2024/03/07/%E8%87%AA%E5%8A%A8%E5%8C%96/selenium_4.10/" rel="bookmark" title="selenium 4.10">selenium 4.10</a></li><li class="active"><a href="/yangxs.github.io/2024/03/07/%E8%87%AA%E5%8A%A8%E5%8C%96/selenium_3.141.0/" rel="bookmark" title="selenium 3.141.0">selenium 3.141.0</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="yangxs" data-src="/yangxs.github.io/images/avatar.png"><p class="name" itemprop="name">yangxs</p><div class="description" itemprop="description"></div></div><nav class="state"><div class="item posts"><a href="/yangxs.github.io/archives/"><span class="count">11</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/yangxs.github.io/categories/"><span class="count">7</span> <span class="name">分类</span></a></div><div class="item tags"><a href="/yangxs.github.io/tags/"><span class="count">8</span> <span class="name">标签</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL3N1bkZvclJpdHVhbA==" title="https:&#x2F;&#x2F;github.com&#x2F;sunForRitual"><i class="ic i-github"></i></span></div><ul class="menu"><li class="item"><a href="/yangxs.github.io/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item"><a href="/yangxs.github.io/about/" rel="section"><i class="ic i-user"></i>关于</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>文章</a><ul class="submenu"><li class="item"><a href="/yangxs.github.io/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/yangxs.github.io/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/yangxs.github.io/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul></li><li class="item"><a href="/yangxs.github.io/friends/" rel="section"><i class="ic i-heart"></i>friends</a></li><li class="item"><a href="/yangxs.github.io/links/" rel="section"><i class="ic i-magic"></i>links</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/yangxs.github.io/2024/03/07/%E8%87%AA%E5%8A%A8%E5%8C%96/selenium_4.10/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/yangxs.github.io/2024/03/07/spider/Java%E7%88%AC%E8%99%AB%E5%AE%9E%E7%8E%B0/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"><a href="/yangxs.github.io/categories/%E4%B8%BB%E9%A2%98%E8%AE%BE%E7%BD%AE/" title="分类于 主题设置">主题设置</a> <i class="ic i-angle-right"></i> <a href="/yangxs.github.io/categories/%E4%B8%BB%E9%A2%98%E8%AE%BE%E7%BD%AE/shoka/" title="分类于 shoka">shoka</a></div><span><a href="/yangxs.github.io/2024/03/08/%E4%B8%BB%E9%A2%98%E8%AE%BE%E7%BD%AE/shoka/md%E6%96%87%E4%BB%B6Front%20Matter%E7%9B%B8%E5%85%B3%E9%85%8D%E7%BD%AE/" title="shoka md文件Fornt Matter配置">shoka md文件Fornt Matter配置</a></span></li><li class="item"><div class="breadcrumb"><a href="/yangxs.github.io/categories/%E8%87%AA%E5%8A%A8%E5%8C%96/" title="分类于 自动化">自动化</a></div><span><a href="/yangxs.github.io/2024/03/07/%E8%87%AA%E5%8A%A8%E5%8C%96/selenium_3.141.0/" title="selenium 3.141.0">selenium 3.141.0</a></span></li><li class="item"><div class="breadcrumb"><a href="/yangxs.github.io/categories/%E4%B8%BB%E9%A2%98%E8%AE%BE%E7%BD%AE/" title="分类于 主题设置">主题设置</a> <i class="ic i-angle-right"></i> <a href="/yangxs.github.io/categories/%E4%B8%BB%E9%A2%98%E8%AE%BE%E7%BD%AE/shoka/" title="分类于 shoka">shoka</a></div><span><a href="/yangxs.github.io/2024/03/08/%E4%B8%BB%E9%A2%98%E8%AE%BE%E7%BD%AE/shoka/%E6%90%9C%E7%B4%A2%E5%8A%9F%E8%83%BD/" title="shoka搜索功能配置">shoka搜索功能配置</a></span></li><li class="item"><div class="breadcrumb"><a href="/yangxs.github.io/categories/%E8%87%AA%E5%8A%A8%E5%8C%96/" title="分类于 自动化">自动化</a></div><span><a href="/yangxs.github.io/2024/03/07/%E8%87%AA%E5%8A%A8%E5%8C%96/pyautogui%E8%87%AA%E5%8A%A8%E5%8C%96/" title="pyautogui">pyautogui</a></span></li><li class="item"><div class="breadcrumb"><a href="/yangxs.github.io/categories/spider/" title="分类于 spider">spider</a></div><span><a href="/yangxs.github.io/2024/03/01/spider/Xpath%E9%AB%98%E7%BA%A7%E7%94%A8%E6%B3%95/" title="xpath 高级用法">xpath 高级用法</a></span></li><li class="item"><div class="breadcrumb"><a href="/yangxs.github.io/categories/%E4%B8%BB%E9%A2%98%E8%AE%BE%E7%BD%AE/" title="分类于 主题设置">主题设置</a> <i class="ic i-angle-right"></i> <a href="/yangxs.github.io/categories/%E4%B8%BB%E9%A2%98%E8%AE%BE%E7%BD%AE/shoka/" title="分类于 shoka">shoka</a></div><span><a href="/yangxs.github.io/2024/04/03/%E4%B8%BB%E9%A2%98%E8%AE%BE%E7%BD%AE/shoka/%E9%A1%B5%E9%9D%A2%E6%98%BE%E7%A4%BA%E7%9B%B8%E5%85%B3%E8%AE%BE%E7%BD%AE/" title="shoka主题页面显示相关设置">shoka主题页面显示相关设置</a></span></li><li class="item"><div class="breadcrumb"><a href="/yangxs.github.io/categories/%E8%87%AA%E5%8A%A8%E5%8C%96/" title="分类于 自动化">自动化</a></div><span><a href="/yangxs.github.io/2024/03/07/%E8%87%AA%E5%8A%A8%E5%8C%96/selenium_4.10/" title="selenium 4.10">selenium 4.10</a></span></li><li class="item"><div class="breadcrumb"><a href="/yangxs.github.io/categories/python/" title="分类于 python">python</a></div><span><a href="/yangxs.github.io/2024/03/01/python/%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1/" title="定时任务">定时任务</a></span></li><li class="item"><div class="breadcrumb"><a href="/yangxs.github.io/categories/JS%E9%80%86%E5%90%91/" title="分类于 JS逆向">JS逆向</a></div><span><a href="/yangxs.github.io/2024/03/04/JS%E9%80%86%E5%90%91/%E5%B8%B8%E7%94%A8hook/" title="常用hook">常用hook</a></span></li><li class="item"><div class="breadcrumb"><a href="/yangxs.github.io/categories/spider/" title="分类于 spider">spider</a></div><span><a href="/yangxs.github.io/2024/03/07/spider/Java%E7%88%AC%E8%99%AB%E5%AE%9E%E7%8E%B0/" title="Java爬虫">Java爬虫</a></span></li></ul></div><div><h2>最新评论</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright"><span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">yangxs @ yangxs</span></div><div id="running-time">本站已经运行了 <span id="years">0</span> 年 <span id="days">0</span> 天 <span id="hours">0</span> 小时 <span id="minutes">0</span> 分 <span id="seconds">0</span> 秒</div><div class="powered-by">基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div><script>function updateRunningTime(){const e=new Date("2024-03-01T16:04:42"),t=new Date,n=t-e,o=Math.floor(n/1e3%60),d=Math.floor(n/1e3/60%60),m=Math.floor(n/1e3/60/60%24),u=Math.floor(n/1e3/60/60/24%365),a=Math.floor(n/1e3/60/60/24/365);document.getElementById("years").textContent=a,document.getElementById("days").textContent=u,document.getElementById("hours").textContent=m,document.getElementById("minutes").textContent=d,document.getElementById("seconds").textContent=o}updateRunningTime(),setInterval(updateRunningTime,1e3)</script></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"2024/03/07/自动化/selenium_3.141.0/",favicon:{show:"（●´3｀●）やれやれだぜ",hide:"(´Д｀)哦豁だ！"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:!0,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/yangxs.github.io/js/app.js?v=0.2.5"></script></body></html><!-- rebuild by hrmmi -->